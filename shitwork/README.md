# 开发前言  

- [x] 处理文件程序  
- [ ] flask 后端  
- [ ] postgresql  
- [ ] html  

## 处理文件思路  

- 故障书唯一码，保密级别，故障书编号应采用捕获<w:t>的方法直接获取  
- 故障书全篇除上述字段外均为表格形式记录，表格内字段目前均采用固定标志位录入, 现象、排障经过、原因分析这三个部分目前一起存，后续估计会分开，有效字段处理至纠正和预防措施
- 故障书包含图片可直接提取，在表格内的文字描述后续优化

图片处理思路  
为每一个docx新建一个tmp文件夹，将图片存入tmp，统一执行插入  

整体处理思路  
表格值输入至临时文件夹的data/txt文件，图片亦输出至临时文件夹的image目录下  
多进程处理，将已处理的文档生成的临时文件记录至消息队列，生产者负责上述操作，消费者负责将上述操作的产生的数据写入到数据库。  

存在可能重复的值
处理起止日期和时间-影响业务时间  
历时1-历时2  
主机系统停机时间-历时1  
仅历时1-历时2需要处理  
栈思想去重, 然后特殊处理历时一二,目前校验过三个docx均成功.

2023-04-09  
1、重新设计不应该使用字典，改用pandas写入csv
直接sqlalchemy通过csv直接写入数据库
2、实现ORM手动插入接口


